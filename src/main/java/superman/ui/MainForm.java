package superman.ui;

import superman.core.ShellUpload;
import superman.core.Store;
import superman.core.VulCheck;
import superman.core.VulExec;

import javax.swing.*;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;

public class MainForm {
    private JPanel mainPanel;
    private JTabbedPane tabbedPane1;
    private JTextField urlTextField;
    private JCheckBox dnslogCheckBox;
    private JComboBox vulComboBox;
    private JButton checkButton;
    private JTextArea infoTextArea;
    private JTextField cmdTextField;
    private JButton execButton;
    private JTextArea execTextArea;
    private JTextArea shellTextArea;
    private JTextField pathTextField;
    private JButton uploadButton;
    private JFrame frame ;
    private static MainForm mainForm;

    public static MainForm getMainForm(){
        if(mainForm==null){
            mainForm=new MainForm();
        }
        return mainForm;
    }
    public void show(){
        frame.setVisible(true);
    }

    public MainForm(){
        frame=new JFrame("Weblogic漏洞利用工具by 21superman");
        frame.setContentPane(mainPanel);
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        frame.pack();
        frame.setSize(800,600);
        frame.setLocationRelativeTo(null);
        init();
    }

    public JTextField getUrlTextField() {
        return urlTextField;
    }

    public JCheckBox getDnslogCheckBox() {
        return dnslogCheckBox;
    }

    public JComboBox getVulComboBox() {
        return vulComboBox;
    }

    public JButton getCheckButton() {
        return checkButton;
    }

    public JTextArea getInfoTextArea() {
        return infoTextArea;
    }

    public JTextField getCmdTextField() {
        return cmdTextField;
    }

    public JButton getExecButton() {
        return execButton;
    }

    public JTextArea getExecTextArea() {
        return execTextArea;
    }

    public JTextArea getShellTextArea() {
        return shellTextArea;
    }

    public JTextField getPathTextField() {
        return pathTextField;
    }

    public JButton getUploadButton() {
        return uploadButton;
    }

    private void init() {
        vulComboBox.addItem("ECHO_ALL");
        vulComboBox.addItem("NO_ECHO_ALL");
        for(String name: Store.ECHO_VUL_LIST.keySet()){
            vulComboBox.addItem(name);
        }
        for(String name: Store.NO_ECHO_VUL_LIST.keySet()){
            vulComboBox.addItem(name);
        }
        checkButton.addActionListener(new ActionListener() {
            @Override
            public void actionPerformed(ActionEvent e) {
                new VulCheck().start();
            }
        });
        execButton.addActionListener(new ActionListener() {
            @Override
            public void actionPerformed(ActionEvent e) {
                new VulExec().start();
            }
        });
        uploadButton.addActionListener(new ActionListener() {
            @Override
            public void actionPerformed(ActionEvent e) {
                new ShellUpload().start();
            }
        });
    }

}
